<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Faviconify ‚Äî Free Favicon Generator | Create Favicons from Text, Emoji & Images</title>
    <meta name="description" content="Generate favicons from text, emoji, or images. Download all sizes (16x16 to 512x512) as PNG + ICO. Free, no signup, works in your browser.">
    <meta name="keywords" content="favicon generator, favicon maker, create favicon, favicon from text, favicon from emoji, ico generator, favicon sizes, free favicon tool">
    <link rel="canonical" href="https://mack-moneymaker.github.io/faviconify/">

    <!-- Open Graph -->
    <meta property="og:title" content="Faviconify ‚Äî Free Favicon Generator">
    <meta property="og:description" content="Generate favicons from text, emoji, or images. All sizes, PNG + ICO. Free, no signup.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://mack-moneymaker.github.io/faviconify/">
    <meta property="og:site_name" content="Faviconify">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Faviconify ‚Äî Free Favicon Generator">
    <meta name="twitter:description" content="Generate favicons from text, emoji, or images. All sizes, PNG + ICO. Free.">

    <!-- JSON-LD -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Faviconify",
        "url": "https://mack-moneymaker.github.io/faviconify/",
        "description": "Free favicon generator from text, emoji, or images. Download all sizes as PNG and ICO.",
        "applicationCategory": "DesignApplication",
        "operatingSystem": "Web",
        "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
        "author": { "@type": "Organization", "name": "Mack", "url": "https://rendly-api.fly.dev" }
    }
    </script>

    <style>
        *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --bg: #0f172a;
            --surface: #1e293b;
            --surface-2: #334155;
            --text: #f1f5f9;
            --text-muted: #94a3b8;
            --border: #475569;
            --success: #22c55e;
            --radius: 12px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container { max-width: 900px; margin: 0 auto; padding: 2rem 1.5rem; }

        header { text-align: center; margin-bottom: 3rem; }
        header h1 { font-size: 2.5rem; margin-bottom: 0.5rem; }
        header h1 span { color: var(--primary); }
        header p { color: var(--text-muted); font-size: 1.1rem; }

        .tabs {
            display: flex; gap: 0; margin-bottom: 2rem;
            border: 1px solid var(--border); border-radius: var(--radius);
            overflow: hidden;
        }
        .tab {
            flex: 1; padding: 0.75rem; text-align: center; cursor: pointer;
            background: var(--surface); border: none; color: var(--text-muted);
            font-size: 1rem; transition: all 0.2s;
        }
        .tab:hover { background: var(--surface-2); }
        .tab.active { background: var(--primary); color: white; }

        .panel { display: none; }
        .panel.active { display: block; }

        .form-group { margin-bottom: 1.5rem; }
        .form-group label { display: block; margin-bottom: 0.5rem; font-weight: 600; font-size: 0.9rem; }
        .form-group input, .form-group select, .form-group textarea {
            width: 100%; padding: 0.75rem 1rem; background: var(--surface);
            border: 1px solid var(--border); border-radius: 8px; color: var(--text);
            font-size: 1rem;
        }
        .form-group input:focus, .form-group select:focus {
            outline: none; border-color: var(--primary);
        }

        .row { display: flex; gap: 1rem; }
        .row > * { flex: 1; }

        .color-input-wrap {
            display: flex; align-items: center; gap: 0.75rem;
        }
        .color-input-wrap input[type="color"] {
            width: 48px; height: 40px; padding: 2px; cursor: pointer;
            border-radius: 8px; border: 1px solid var(--border);
        }
        .color-input-wrap input[type="text"] { flex: 1; }

        .preview-section {
            background: var(--surface); border-radius: var(--radius);
            padding: 2rem; margin-bottom: 2rem; text-align: center;
        }
        .preview-section h3 { margin-bottom: 1.5rem; }

        .preview-grid {
            display: flex; gap: 1.5rem; justify-content: center;
            align-items: flex-end; flex-wrap: wrap;
        }
        .preview-item { text-align: center; }
        .preview-item canvas {
            border-radius: 8px; image-rendering: pixelated;
            border: 1px solid var(--border); background: #fff;
        }
        .preview-item span { display: block; margin-top: 0.5rem; color: var(--text-muted); font-size: 0.8rem; }

        .browser-mockup {
            background: var(--surface-2); border-radius: 10px; padding: 0;
            max-width: 500px; margin: 1.5rem auto 0; overflow: hidden;
            border: 1px solid var(--border);
        }
        .browser-bar {
            background: var(--surface); padding: 8px 12px;
            display: flex; align-items: center; gap: 8px;
        }
        .browser-dots { display: flex; gap: 5px; }
        .browser-dots span { width: 10px; height: 10px; border-radius: 50%; }
        .browser-dots span:nth-child(1) { background: #ef4444; }
        .browser-dots span:nth-child(2) { background: #eab308; }
        .browser-dots span:nth-child(3) { background: #22c55e; }
        .browser-url {
            flex: 1; background: var(--surface-2); border-radius: 4px;
            padding: 4px 8px; font-size: 0.75rem; color: var(--text-muted);
            display: flex; align-items: center; gap: 6px;
        }
        .browser-url canvas { border-radius: 2px; flex-shrink: 0; }
        .browser-body { padding: 2rem; text-align: center; color: var(--text-muted); }

        .btn {
            display: inline-flex; align-items: center; gap: 0.5rem;
            padding: 0.75rem 1.5rem; border: none; border-radius: 8px;
            font-size: 1rem; cursor: pointer; font-weight: 600;
            transition: all 0.2s;
        }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: var(--primary-dark); }
        .btn-outline {
            background: transparent; color: var(--text);
            border: 1px solid var(--border);
        }
        .btn-outline:hover { background: var(--surface); }

        .download-section { text-align: center; margin: 2rem 0; }
        .download-buttons { display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; margin-top: 1rem; }

        .html-code {
            background: var(--surface); border: 1px solid var(--border);
            border-radius: 8px; padding: 1rem; margin-top: 2rem;
            position: relative; text-align: left;
        }
        .html-code pre {
            font-family: 'SF Mono', Consolas, monospace; font-size: 0.85rem;
            color: var(--text-muted); overflow-x: auto; white-space: pre-wrap;
        }
        .html-code .copy-btn {
            position: absolute; top: 8px; right: 8px;
            background: var(--surface-2); border: 1px solid var(--border);
            color: var(--text-muted); padding: 4px 10px; border-radius: 4px;
            cursor: pointer; font-size: 0.8rem;
        }
        .html-code .copy-btn:hover { color: var(--text); }

        .drop-zone {
            border: 2px dashed var(--border); border-radius: var(--radius);
            padding: 3rem; text-align: center; cursor: pointer;
            transition: all 0.2s; margin-bottom: 1.5rem;
        }
        .drop-zone:hover, .drop-zone.dragover {
            border-color: var(--primary); background: rgba(99, 102, 241, 0.05);
        }
        .drop-zone p { color: var(--text-muted); margin-top: 0.5rem; }
        .drop-zone .icon { font-size: 2.5rem; }

        .faq { margin-top: 4rem; }
        .faq h2 { text-align: center; margin-bottom: 2rem; }
        .faq-item { background: var(--surface); border-radius: var(--radius); padding: 1.5rem; margin-bottom: 1rem; }
        .faq-item h3 { margin-bottom: 0.5rem; font-size: 1rem; }
        .faq-item p { color: var(--text-muted); font-size: 0.95rem; }

        .cta-banner {
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: var(--radius); padding: 2rem; text-align: center;
            margin-top: 3rem;
        }
        .cta-banner h3 { margin-bottom: 0.5rem; }
        .cta-banner p { opacity: 0.9; margin-bottom: 1rem; }
        .cta-banner a {
            display: inline-block; background: white; color: var(--primary);
            padding: 0.75rem 1.5rem; border-radius: 8px; text-decoration: none;
            font-weight: 700;
        }
        .cta-banner a:hover { opacity: 0.9; }

        footer { text-align: center; margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border); }
        footer p { color: var(--text-muted); font-size: 0.9rem; }
        footer a { color: var(--primary); text-decoration: none; }

        @media (max-width: 600px) {
            header h1 { font-size: 1.75rem; }
            .row { flex-direction: column; }
            .preview-grid { gap: 1rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üé® <span>Faviconify</span></h1>
            <p>Generate beautiful favicons from text, emoji, or images ‚Äî free, no signup</p>
        </header>

        <div class="tabs">
            <button class="tab active" data-tab="text" onclick="switchTab('text')">‚úèÔ∏è Text / Letter</button>
            <button class="tab" data-tab="emoji" onclick="switchTab('emoji')">üòÄ Emoji</button>
            <button class="tab" data-tab="image" onclick="switchTab('image')">üñºÔ∏è Image Upload</button>
        </div>

        <!-- Text Tab -->
        <div class="panel active" id="panel-text">
            <div class="row">
                <div class="form-group">
                    <label>Text (1-2 characters)</label>
                    <input type="text" id="text-input" value="M" maxlength="2" oninput="render()">
                </div>
                <div class="form-group">
                    <label>Font</label>
                    <select id="text-font" onchange="render()">
                        <option value="Inter, sans-serif">Inter</option>
                        <option value="Georgia, serif">Georgia</option>
                        <option value="'Courier New', monospace">Courier</option>
                        <option value="Impact, sans-serif">Impact</option>
                        <option value="'Comic Sans MS', cursive">Comic Sans</option>
                    </select>
                </div>
            </div>
            <div class="row">
                <div class="form-group">
                    <label>Text Color</label>
                    <div class="color-input-wrap">
                        <input type="color" id="text-color" value="#ffffff" oninput="syncColor('text-color');render()">
                        <input type="text" id="text-color-hex" value="#ffffff" oninput="syncHex('text-color');render()">
                    </div>
                </div>
                <div class="form-group">
                    <label>Background</label>
                    <div class="color-input-wrap">
                        <input type="color" id="text-bg" value="#6366f1" oninput="syncColor('text-bg');render()">
                        <input type="text" id="text-bg-hex" value="#6366f1" oninput="syncHex('text-bg');render()">
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="form-group">
                    <label>Shape</label>
                    <select id="text-shape" onchange="render()">
                        <option value="rounded">Rounded Square</option>
                        <option value="circle">Circle</option>
                        <option value="square">Square</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Font Size (%)</label>
                    <input type="range" id="text-size" min="30" max="90" value="65" oninput="render()" style="accent-color: var(--primary);">
                </div>
            </div>
        </div>

        <!-- Emoji Tab -->
        <div class="panel" id="panel-emoji">
            <div class="form-group">
                <label>Pick an Emoji</label>
                <input type="text" id="emoji-input" value="üöÄ" maxlength="4" oninput="render()" style="font-size: 2rem; text-align: center;">
            </div>
            <div class="row">
                <div class="form-group">
                    <label>Background</label>
                    <select id="emoji-bg-type" onchange="render()">
                        <option value="transparent">Transparent</option>
                        <option value="color">Solid Color</option>
                    </select>
                </div>
                <div class="form-group" id="emoji-color-group" style="display:none;">
                    <label>Background Color</label>
                    <div class="color-input-wrap">
                        <input type="color" id="emoji-bg" value="#1e293b" oninput="syncColor('emoji-bg');render()">
                        <input type="text" id="emoji-bg-hex" value="#1e293b" oninput="syncHex('emoji-bg');render()">
                    </div>
                </div>
            </div>
        </div>

        <!-- Image Tab -->
        <div class="panel" id="panel-image">
            <div class="drop-zone" id="drop-zone" onclick="document.getElementById('file-input').click()">
                <div class="icon">üìÅ</div>
                <p>Drop an image here or click to upload</p>
                <p><small>PNG, JPG, SVG, or WebP ‚Äî any size</small></p>
            </div>
            <input type="file" id="file-input" accept="image/*" style="display:none" onchange="handleFileUpload(event)">
            <div class="form-group">
                <label>Background</label>
                <select id="img-bg-type" onchange="render()">
                    <option value="transparent">Transparent (best for logos)</option>
                    <option value="contain">Contain with padding</option>
                </select>
            </div>
        </div>

        <!-- Preview -->
        <div class="preview-section">
            <h3>Preview</h3>
            <div class="preview-grid">
                <div class="preview-item">
                    <canvas id="preview-16" width="16" height="16" style="width:32px;height:32px;"></canvas>
                    <span>16√ó16</span>
                </div>
                <div class="preview-item">
                    <canvas id="preview-32" width="32" height="32" style="width:48px;height:48px;"></canvas>
                    <span>32√ó32</span>
                </div>
                <div class="preview-item">
                    <canvas id="preview-48" width="48" height="48" style="width:64px;height:64px;"></canvas>
                    <span>48√ó48</span>
                </div>
                <div class="preview-item">
                    <canvas id="preview-180" width="180" height="180" style="width:90px;height:90px;"></canvas>
                    <span>180√ó180<br>(Apple Touch)</span>
                </div>
                <div class="preview-item">
                    <canvas id="preview-192" width="192" height="192" style="width:96px;height:96px;"></canvas>
                    <span>192√ó192<br>(Android)</span>
                </div>
                <div class="preview-item">
                    <canvas id="preview-512" width="512" height="512" style="width:100px;height:100px;"></canvas>
                    <span>512√ó512</span>
                </div>
            </div>

            <div class="browser-mockup">
                <div class="browser-bar">
                    <div class="browser-dots"><span></span><span></span><span></span></div>
                    <div class="browser-url">
                        <canvas id="preview-tab" width="16" height="16" style="width:16px;height:16px;"></canvas>
                        <span>yoursite.com</span>
                    </div>
                </div>
                <div class="browser-body">Your website with the new favicon ‚ú®</div>
            </div>
        </div>

        <!-- Download -->
        <div class="download-section">
            <h3>Download Your Favicon</h3>
            <div class="download-buttons">
                <button class="btn btn-primary" onclick="downloadAll()">‚¨áÔ∏è Download All Sizes (ZIP)</button>
                <button class="btn btn-outline" onclick="downloadICO()">üìÑ Download .ICO</button>
            </div>
        </div>

        <!-- HTML Code -->
        <div class="html-code">
            <button class="copy-btn" onclick="copyHTML()">Copy</button>
            <pre id="html-snippet">&lt;!-- Favicon --&gt;
&lt;link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"&gt;
&lt;link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"&gt;
&lt;link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"&gt;
&lt;link rel="icon" type="image/x-icon" href="/favicon.ico"&gt;
&lt;link rel="manifest" href="/site.webmanifest"&gt;</pre>
        </div>

        <!-- FAQ -->
        <section class="faq">
            <h2>Frequently Asked Questions</h2>
            <div class="faq-item">
                <h3>What is a favicon?</h3>
                <p>A favicon (short for "favorite icon") is the small icon shown in browser tabs, bookmarks, and history. It helps users quickly identify your website among many open tabs.</p>
            </div>
            <div class="faq-item">
                <h3>What sizes do I need?</h3>
                <p>For maximum compatibility: 16√ó16 and 32√ó32 (browser tabs), 180√ó180 (Apple Touch Icon for iOS), 192√ó192 and 512√ó512 (Android/PWA). Faviconify generates all of these for you.</p>
            </div>
            <div class="faq-item">
                <h3>PNG or ICO ‚Äî which should I use?</h3>
                <p>Modern browsers support PNG favicons perfectly. ICO is only needed for very old browsers (IE10 and below). We recommend using PNG with an ICO fallback, which is exactly what the HTML snippet above does.</p>
            </div>
            <div class="faq-item">
                <h3>Can I use an emoji as my favicon?</h3>
                <p>Yes! Switch to the Emoji tab, pick any emoji, and we'll render it as a crisp favicon in all sizes. Great for quick prototypes or fun side projects.</p>
            </div>
            <div class="faq-item">
                <h3>How do I add the favicon to my website?</h3>
                <p>Download the files, place them in your website's root directory, and paste the HTML snippet into your &lt;head&gt; tag. That's it ‚Äî takes 30 seconds.</p>
            </div>
            <div class="faq-item">
                <h3>Is this really free?</h3>
                <p>100% free. No signup, no watermarks, no limits. Everything runs in your browser ‚Äî we don't even upload your images to a server.</p>
            </div>
        </section>

        <!-- CTA -->
        <div class="cta-banner">
            <h3>Need to generate images at scale?</h3>
            <p>Rendly's API generates screenshots, OG images, and HTML-to-image renders with a single API call.</p>
            <a href="https://rendly-api.fly.dev?ref=faviconify" target="_blank">Try Rendly Free ‚Üí</a>
        </div>

        <div style="margin:2rem 0;padding:1.5rem;background:var(--bg-card,#f8f9fa);border-radius:12px;text-align:center;">
            <p style="font-weight:600;margin-bottom:0.75rem;">üõ†Ô∏è More Free Developer Tools</p>
            <div style="display:flex;flex-wrap:wrap;gap:0.5rem;justify-content:center;">
                <a href="https://mack-moneymaker.github.io/sigcraft/" target="_blank" style="padding:0.4rem 0.8rem;background:var(--bg,#fff);border:1px solid var(--border,#ddd);border-radius:6px;text-decoration:none;color:var(--text,#333);font-size:0.9rem;">‚úâÔ∏è SigCraft</a>
                <a href="https://mack-moneymaker.github.io/gradientlab/" target="_blank" style="padding:0.4rem 0.8rem;background:var(--bg,#fff);border:1px solid var(--border,#ddd);border-radius:6px;text-decoration:none;color:var(--text,#333);font-size:0.9rem;">üåà GradientLab</a>
                <a href="https://mack-moneymaker.github.io/colorcraft/" target="_blank" style="padding:0.4rem 0.8rem;background:var(--bg,#fff);border:1px solid var(--border,#ddd);border-radius:6px;text-decoration:none;color:var(--text,#333);font-size:0.9rem;">üé® ColorCraft</a>
                <a href="https://mack-moneymaker.github.io/jsonpretty/" target="_blank" style="padding:0.4rem 0.8rem;background:var(--bg,#fff);border:1px solid var(--border,#ddd);border-radius:6px;text-decoration:none;color:var(--text,#333);font-size:0.9rem;">üìã JSONPretty</a>
                <a href="https://mack-moneymaker.github.io/cronmaker/" target="_blank" style="padding:0.4rem 0.8rem;background:var(--bg,#fff);border:1px solid var(--border,#ddd);border-radius:6px;text-decoration:none;color:var(--text,#333);font-size:0.9rem;">‚è∞ CronMaker</a>
                <a href="https://mack-moneymaker.github.io/regexlab/" target="_blank" style="padding:0.4rem 0.8rem;background:var(--bg,#fff);border:1px solid var(--border,#ddd);border-radius:6px;text-decoration:none;color:var(--text,#333);font-size:0.9rem;">üîç RegexLab</a>
                <a href="https://hookdebug-app.fly.dev/" target="_blank" style="padding:0.4rem 0.8rem;background:var(--bg,#fff);border:1px solid var(--border,#ddd);border-radius:6px;text-decoration:none;color:var(--text,#333);font-size:0.9rem;">ü™ù HookDebug</a>
                <a href="https://justtherecipe-app.fly.dev/" target="_blank" style="padding:0.4rem 0.8rem;background:var(--bg,#fff);border:1px solid var(--border,#ddd);border-radius:6px;text-decoration:none;color:var(--text,#333);font-size:0.9rem;">üç≥ JustTheRecipe</a>
            </div>
            <p style="margin-top:0.75rem;font-size:0.85rem;color:var(--text-muted,#666);">All free. All open source. Powered by <a href="https://rendly-api.fly.dev" style="color:var(--primary,#4f46e5);">Rendly</a>.</p>
        </div>

        <footer>
            <p>Built by <a href="https://github.com/mack-moneymaker" target="_blank">Mack</a> ¬∑ <a href="https://rendly-api.fly.dev" target="_blank">Rendly</a> ¬∑ <a href="https://mack-moneymaker.github.io/sigcraft/" target="_blank">SigCraft</a></p>
        </footer>
    </div>

    <script>
    let uploadedImage = null;
    const SIZES = [16, 32, 48, 180, 192, 512];

    function switchTab(tab) {
        document.querySelectorAll('.tab').forEach(t => t.classList.toggle('active', t.dataset.tab === tab));
        document.querySelectorAll('.panel').forEach(p => p.classList.toggle('active', p.id === 'panel-' + tab));
        render();
    }

    function syncColor(id) {
        document.getElementById(id + '-hex').value = document.getElementById(id).value;
    }
    function syncHex(id) {
        const hex = document.getElementById(id + '-hex').value;
        if (/^#[0-9a-fA-F]{6}$/.test(hex)) document.getElementById(id).value = hex;
    }

    function getActiveTab() {
        return document.querySelector('.tab.active').dataset.tab;
    }

    function drawFavicon(canvas, size) {
        const ctx = canvas.getContext('2d');
        canvas.width = size;
        canvas.height = size;
        ctx.clearRect(0, 0, size, size);

        const tab = getActiveTab();

        if (tab === 'text') {
            const text = document.getElementById('text-input').value || 'M';
            const font = document.getElementById('text-font').value;
            const color = document.getElementById('text-color').value;
            const bg = document.getElementById('text-bg').value;
            const shape = document.getElementById('text-shape').value;
            const fontSizePct = parseInt(document.getElementById('text-size').value);

            // Background shape
            ctx.fillStyle = bg;
            if (shape === 'circle') {
                ctx.beginPath();
                ctx.arc(size/2, size/2, size/2, 0, Math.PI * 2);
                ctx.fill();
            } else if (shape === 'rounded') {
                const r = size * 0.2;
                ctx.beginPath();
                ctx.moveTo(r, 0);
                ctx.lineTo(size - r, 0);
                ctx.quadraticCurveTo(size, 0, size, r);
                ctx.lineTo(size, size - r);
                ctx.quadraticCurveTo(size, size, size - r, size);
                ctx.lineTo(r, size);
                ctx.quadraticCurveTo(0, size, 0, size - r);
                ctx.lineTo(0, r);
                ctx.quadraticCurveTo(0, 0, r, 0);
                ctx.fill();
            } else {
                ctx.fillRect(0, 0, size, size);
            }

            // Text
            const fontSize = Math.round(size * fontSizePct / 100);
            ctx.fillStyle = color;
            ctx.font = `bold ${fontSize}px ${font}`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(text, size/2, size/2 + size * 0.03);

        } else if (tab === 'emoji') {
            const emoji = document.getElementById('emoji-input').value || 'üöÄ';
            const bgType = document.getElementById('emoji-bg-type').value;

            if (bgType === 'color') {
                const bg = document.getElementById('emoji-bg').value;
                ctx.fillStyle = bg;
                ctx.fillRect(0, 0, size, size);
            }

            const fontSize = Math.round(size * 0.75);
            ctx.font = `${fontSize}px serif`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(emoji, size/2, size/2 + size * 0.05);

        } else if (tab === 'image' && uploadedImage) {
            const bgType = document.getElementById('img-bg-type').value;
            const img = uploadedImage;
            const aspect = img.width / img.height;

            if (bgType === 'transparent') {
                // Fill entire canvas
                if (aspect > 1) {
                    const h = size / aspect;
                    ctx.drawImage(img, 0, (size - h) / 2, size, h);
                } else {
                    const w = size * aspect;
                    ctx.drawImage(img, (size - w) / 2, 0, w, size);
                }
            } else {
                // Contain with padding
                const pad = size * 0.1;
                const inner = size - pad * 2;
                if (aspect > 1) {
                    const h = inner / aspect;
                    ctx.drawImage(img, pad, pad + (inner - h) / 2, inner, h);
                } else {
                    const w = inner * aspect;
                    ctx.drawImage(img, pad + (inner - w) / 2, pad, w, inner);
                }
            }
        }
    }

    function render() {
        // Toggle emoji color group
        const emojiColorGroup = document.getElementById('emoji-color-group');
        if (emojiColorGroup) {
            emojiColorGroup.style.display =
                document.getElementById('emoji-bg-type').value === 'color' ? '' : 'none';
        }

        SIZES.forEach(s => {
            const canvas = document.getElementById('preview-' + s);
            if (canvas) drawFavicon(canvas, s);
        });
        // Tab preview
        const tabCanvas = document.getElementById('preview-tab');
        if (tabCanvas) drawFavicon(tabCanvas, 16);
    }

    function handleFileUpload(e) {
        const file = e.target.files[0];
        if (!file) return;
        const img = new Image();
        img.onload = () => { uploadedImage = img; render(); };
        img.src = URL.createObjectURL(file);
    }

    // Drag & drop
    const dropZone = document.getElementById('drop-zone');
    if (dropZone) {
        dropZone.addEventListener('dragover', e => { e.preventDefault(); dropZone.classList.add('dragover'); });
        dropZone.addEventListener('dragleave', () => dropZone.classList.remove('dragover'));
        dropZone.addEventListener('drop', e => {
            e.preventDefault(); dropZone.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file && file.type.startsWith('image/')) {
                const img = new Image();
                img.onload = () => { uploadedImage = img; render(); };
                img.src = URL.createObjectURL(file);
            }
        });
    }

    async function downloadAll() {
        // Simple individual downloads (no zip library dependency)
        for (const size of SIZES) {
            const canvas = document.createElement('canvas');
            drawFavicon(canvas, size);
            const link = document.createElement('a');
            const name = size === 180 ? 'apple-touch-icon.png' : `favicon-${size}x${size}.png`;
            link.download = name;
            link.href = canvas.toDataURL('image/png');
            link.click();
            await new Promise(r => setTimeout(r, 200));
        }
    }

    function downloadICO() {
        // Generate a simple ICO with 16x16 and 32x32
        const sizes = [16, 32];
        const images = sizes.map(s => {
            const c = document.createElement('canvas');
            drawFavicon(c, s);
            return { size: s, canvas: c };
        });

        // ICO format: header + entries + image data (as PNG)
        const pngDatas = images.map(img => {
            const dataUrl = img.canvas.toDataURL('image/png');
            const binary = atob(dataUrl.split(',')[1]);
            const bytes = new Uint8Array(binary.length);
            for (let i = 0; i < binary.length; i++) bytes[i] = binary.charCodeAt(i);
            return { size: img.size, data: bytes };
        });

        const headerSize = 6;
        const entrySize = 16;
        let offset = headerSize + entrySize * pngDatas.length;
        const totalSize = offset + pngDatas.reduce((s, p) => s + p.data.length, 0);
        const buffer = new ArrayBuffer(totalSize);
        const view = new DataView(buffer);

        // Header
        view.setUint16(0, 0, true); // reserved
        view.setUint16(2, 1, true); // ICO type
        view.setUint16(4, pngDatas.length, true);

        // Entries
        let entryOffset = headerSize;
        for (const png of pngDatas) {
            view.setUint8(entryOffset, png.size < 256 ? png.size : 0);
            view.setUint8(entryOffset + 1, png.size < 256 ? png.size : 0);
            view.setUint8(entryOffset + 2, 0); // colors
            view.setUint8(entryOffset + 3, 0); // reserved
            view.setUint16(entryOffset + 4, 1, true); // planes
            view.setUint16(entryOffset + 6, 32, true); // bpp
            view.setUint32(entryOffset + 8, png.data.length, true);
            view.setUint32(entryOffset + 12, offset, true);
            entryOffset += entrySize;
            offset += png.data.length;
        }

        // Image data
        let dataOffset = headerSize + entrySize * pngDatas.length;
        const arr = new Uint8Array(buffer);
        for (const png of pngDatas) {
            arr.set(png.data, dataOffset);
            dataOffset += png.data.length;
        }

        const blob = new Blob([buffer], { type: 'image/x-icon' });
        const link = document.createElement('a');
        link.download = 'favicon.ico';
        link.href = URL.createObjectURL(blob);
        link.click();
    }

    function copyHTML() {
        const code = document.getElementById('html-snippet').textContent;
        navigator.clipboard.writeText(code);
        const btn = document.querySelector('.copy-btn');
        btn.textContent = 'Copied!';
        setTimeout(() => btn.textContent = 'Copy', 2000);
    }

    // Init
    render();
    </script>
</body>
</html>
